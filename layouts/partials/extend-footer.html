<script async src="https://analytics.umami.is/script.js" data-website-id="42551e5b-0378-4474-bc3a-b2849edf2faf"></script>
<script>
  (function (){
    let doNotTrack = localStorage.getItem("insights") === 'do-not-track'

    document.addEventListener(
      "DOMContentLoaded",
      function attachRandomLink() {
        let rnd = [...document.querySelectorAll("nav li > a")].filter(a => a.innerText == "Random")[0]
        if (rnd) {
          rnd.addEventListener(
            "click",
            function sendToRandomArticle(e) {
              e.preventDefault();
              fetch(window.location.origin + '/index.json')
                .then(r => r.json())
                .then(redirectAtRandom)
                .catch(err => console.log(err));
            })
        }
      });

    function redirectAtRandom(data) {
      let randIndex = Math.floor(Math.random() * data.length);
      if (!doNotTrack) umami.track('Random button')
      window.location.href = data[randIndex]['permalink']
    }
  })();
</script>
