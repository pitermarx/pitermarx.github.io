<script src="https://getinsights.io/js/insights.js"></script>
<script>
  (function (){
    let doNotTrack = localStorage.getItem("insights") === 'do-not-track'
    if (!doNotTrack) {
      insights.init('qv5R8zukglcxKmui');
      insights.trackPages();
    }

    document.addEventListener(
      "DOMContentLoaded",
      function attachRandomLink() {
        let rnd = [...document.querySelectorAll("nav li > a")].filter(a => a.innerText == "Random")[0]
        if (rnd) {
          rnd.addEventListener(
            "click",
            function sendToRandomArticle(e) {
              e.preventDefault();
              fetch(window.location.origin + '/index.json')
                .then(r => r.json())
                .then(redirectAtRandom)
                .catch(err => console.log(err));
            })
        }
      });

    function redirectAtRandom(data) {
      let randIndex = Math.floor(Math.random() * data.length);
      if (!doNotTrack) insights.track({ id: "random-button" })
      window.location.href = data[randIndex]['permalink']
    }
  })();
</script>
<!-- Fathom - simple website analytics - https://github.com/usefathom/fathom -->
<script>
(function(d, w, u, f, s, m){
	w[f]=w[f]||function(){
		(w[f].q=w[f].q||[]).push(arguments)
	};
	s=d.createElement('script'),
	m=d.getElementsByTagName('script')[0];
	s.async=1; s.src=u; s.id='fathom-script';
	m.parentNode.insertBefore(s,m)
})(document, window, '//actual.pitermarx.com/tracker.js', 'fathom');
fathom('set', 'siteId', 'PRPRE');
fathom('trackPageview');
</script>
<!-- / Fathom -->